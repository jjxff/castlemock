# Castle Mock v1.69.3 Changelog

## üîê Random Hexadecimal Expression

### New RANDOM_HEX Expression
- **Added `${RANDOM_HEX()}` expression** for generating cryptographically secure random hexadecimal strings
- **Configurable length parameter**: `${RANDOM_HEX(length="64")}` supports any positive integer length
- **Default 32-character length** when no parameter specified
- **Cryptographically secure**: Uses `SecureRandom` for high-quality randomness
- **Perfect for**:
  - API keys and tokens
  - Transaction IDs
  - Session identifiers
  - Cryptocurrency-style addresses
  - SHA hash simulations

### Examples
```
${RANDOM_HEX}                    // 32 chars: a1b2c3d4e5f67890abcdef1234567890
${RANDOM_HEX(length="16")}       // 16 chars: a1b2c3d4e5f67890
${RANDOM_HEX(length="64")}       // 64 chars: cbd198b7ddc8e078435e99aea97546110f98b5011f107295d977c590d0960ec3f
${RANDOM_HEX(length="128")}      // 128 chars: Similar to SHA-512 output
```

## üîß ANTLR Grammar Enhancement

### Fixed JWT Expression Parsing Issues
- **Underscore support in argument names**: `is_valid`, `user_id`, `created_at` now work correctly
- **Unicode character support**: Accented characters like "C√≥digo" are properly parsed
- **Improved string parsing**: Removed problematic backslash handling that caused parse errors
- **Enhanced argument validation**: Better error handling for malformed expressions

### Previously Failing Examples Now Work
```json
{
  "access_token": "${JWT(algorithm=\"HS512\", secret=\"my-secret-key\", factor=\"@body.userId\", is_valid=\"true\", issuer=\"srv-authfactors-arq\", status=\"C√≥digo OTP verificado\", exp=\"+300\")}"
}
```

### Grammar Improvements
- **Fixed `argumentString` rule**: Simplified quote handling to prevent parsing conflicts
- **Updated `string` rule**: Better support for spaces, special characters, and Unicode
- **Added `UNICODE_CHAR` token**: Support for Latin characters with accents (√Ä-…è range)
- **Enhanced `argumentName` rule**: Includes underscore support for database-style naming

## üõ†Ô∏è Technical Improvements

### Expression System
- **Comprehensive test coverage**: Full unit test suite for RANDOM_HEX expression
- **Error handling**: Graceful fallbacks for invalid length parameters
- **Performance optimized**: Efficient byte-to-hex conversion
- **Security focused**: Uses `SecureRandom` instead of standard `Random`

### Code Quality
- **Updated TextParser registration**: RANDOM_HEX properly integrated into expression system
- **Consistent documentation**: JavaDoc comments follow project standards
- **Version consistency**: All POM files updated to 1.69.3

## üìö Documentation Updates

### README.md
- **New RANDOM_HEX section**: Complete usage examples and documentation
- **Updated version references**: Changed from 1.69.2 to 1.69.3
- **Enhanced examples**: Real-world use cases for hexadecimal generation

### Code Comments
- **Detailed JavaDoc**: Comprehensive documentation for RANDOM_HEX class
- **Usage examples**: Inline examples for common length values
- **Parameter descriptions**: Clear explanations of length constraints

## üöÄ Use Cases

### API Development
- **Mock cryptocurrency addresses**: Generate realistic blockchain-style identifiers
- **Session tokens**: Create secure session management in API mocks
- **Transaction IDs**: Simulate payment processing systems
- **API keys**: Mock authentication token generation

### Testing Scenarios
- **Unique identifiers**: Each test run gets unique hex values
- **Hash simulation**: Mock SHA-256/SHA-512 style outputs
- **Security testing**: Generate tokens for authentication scenarios
- **Data validation**: Test systems expecting hexadecimal input

## üîó Related Features

Works seamlessly with existing expressions:
- **JWT tokens**: Use RANDOM_HEX for custom claims requiring hex values
- **Dynamic expressions**: Combine with NOW/DATE for timestamped identifiers
- **Body mapping**: Extract hex values from request bodies using @body.field syntax

## üìù Migration Notes

- **No breaking changes**: All existing functionality remains intact
- **Backward compatible**: Previous expressions continue to work
- **New feature**: RANDOM_HEX is additive, doesn't affect existing mocks

---

**Release Date**: September 26, 2025
**Previous Version**: [1.69.2](1.69.2.md)
**Contributors**: Castle Mock Community

ü§ñ *Generated with [Claude Code](https://claude.ai/code)*